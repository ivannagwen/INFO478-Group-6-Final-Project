---
title: "Exploratory Analysis"
author: "Alan Zheng, Ivanna Maxwell, Kyle Sorstokke"
date: "2/21/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(lubridate)
library(dygraphs)
library(xts)


death_count_data <- read.csv("data/death_count_2020_2022.csv")
covid_data <- read.csv("data/covid19_2020_2022.csv")

# source R files containing charts and analysis
```

## Introduction
In this project, our team aims to explore the relationship between COVID-19 and other causes of deaths within the past 2 years. By combining different [data sets](https://github.com/ivannagwen/INFO478-Group-6-Final-Project/tree/main/data) and analyzing them, we can analyze different characteristics of deaths due to COVID-19 disease, identify who is at higher risk of deaths, and focus on certain resources that minimize the risk of deaths or exposure to COVID-19 disease. To be specific, here are the 3 questions we hope to answer throughout the project:

1. Where does COVID-19 rank related to other long-term causes grouped by specific factors such as location, age group, gender?

2. Is there any correlations present between COVID-19 deaths rate and deaths caused by respiratory illnesses? How is the trend across different groups?

3. How is the trend of COVID-19 deaths related to deaths caused by other groups over time?

In this exploratory report, we will mainly focus on visually and statistically assessing the distribution and relationship of various variables of our interest, which will be discussed below. As a result, we will use different statistical measures such as means, medians, and correlations, as well as different visualization tools including ggplot and plotly.

## Distribution of Variables
**Introduction to section** (what metrics are being plotted (+ description), what are the statistical measures, objectives)


#### ** Visualization 1**

```{r death_dist, echo=FALSE, warning=F}

death_dist <- death_count_data %>%
  filter(Jurisdiction.of.Occurrence=="United States") %>%
  ggplot(aes(Natural.Cause)) +
  geom_boxplot(na.rm=T) +
  xlab("Weekly Natural Death Counts (National)")

death_dist
```

 - Overview of total natural deaths through the timeframe of our data
 - insight 1
 - insight 2
 
#### ** Visualization 2**


```{r covid_dist, echo=FALSE, warning=F, message=F}
gender <- covid_data %>%
  filter(Age.Group == "All Ages", Sex != "All Sexes")

gender_covid <- gender %>%
  ggplot(mapping=aes(x=log(COVID.19.Deaths),color=Sex)) +
  geom_density(na.rm=T)+
  xlim(0,log(50000))+
  xlab("Log COVID Death Counts")

gender_covid
```


 - Log scale for comparison of gendered COVID death counts
 - insight 1
 - insight 2

## Relationships Between Variables
**Introduction to section** (what metrics are being plotted (+ description), objectives about relationships between variables)

#### ** Visualization 1**
```{r evolution, echo=FALSE}
evo_data <- covid_data
evo_data$Start.Date <- mdy(evo_data$Start.Date)
evo_data <- evo_data %>%
  filter(Group == "By Month",
         State == "United States",
         Sex == "All Sexes",
         Age.Group == "All Ages")

prep_data <- xts(x = evo_data$COVID.19.Deaths, order.by = evo_data$Start.Date)

p <- dygraph(prep_data, main = "Covid 19 Evolution", ylab = "Total Death") %>%
  dySeries("V1", label = "Death(All Sexes)") %>%
  dyOptions(labelsUTC = TRUE, fillGraph=TRUE, fillAlpha=0.1, drawGrid = FALSE, colors="#D8AE5A") %>%
  dyRangeSelector() %>%
  dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.5, hideOnMouseOut = FALSE)  %>%
  dyUnzoom() %>%
  dyRoller(rollPeriod = 1)

p
 
```

- description about visualization 1
 - insight 1
 - insight 2

#### ** Visualization 2**
```{r compare,echo=FALSE}
compare_data <- covid_data
compare_data$Start.Date <- mdy(compare_data$Start.Date)
compare_data <- compare_data %>%
  filter(Group == "By Month",
         State == "United States",
         Sex == "All Sexes",
         Age.Group == "All Ages") %>%
  select(Start.Date, COVID.19.Deaths, Pneumonia.Deaths, Influenza.Deaths)
rDeath <- xts(compare_data, order.by = compare_data$Start.Date)

p2 <- dygraph(rDeath, main = "Respiratory Diseases Evolution", ylab = "Total Death") %>%
  dyOptions(stepPlot = TRUE, fillGraph = TRUE) %>%
  dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.5, hideOnMouseOut = FALSE)  %>%
  dyUnzoom() %>%
  dyLegend(width = 600) %>%
  dyRoller(rollPeriod = 1)

p2

```

 - description about visualization 1
 - insight 1
 - insight 2
